# USER STORY: Manage Account Settings and Devices

**ID:** S1.1
**Epic:** E1: User Account Management
**Priority:** P0

---------------------------------------------------------------

## NARRATIVE

**As a** User,
**I want** to manage my account settings, accept terms and conditions, and register my devices from a centralized settings page,
**so that** I can customize my account preferences, maintain compliance with legal requirements, and track my Lenovo devices,
**because** currently there is no way to update alternate contact information, manage terms acceptance, or maintain a list of owned devices for warranty and support purposes.

## ACCEPTANCE CRITERIA

### Business Criteria
- [main] The system MUST provide a Settings page accessible from the user account dropdown menu in the header
- [main] The user MUST be able to view their primary email address (read-only display)
- [main] The user MUST be able to add, edit, and view an alternate email address for notifications
- [main] The system MUST validate that the alternate email is different from the primary email
- [main] The user MUST be able to independently accept or decline two separate terms and conditions:
  - Lenovo Terms & Conditions
  - Software Publisher Terms & Conditions
- [main] The system MUST persist terms acceptance state across sessions
- [main] The user MUST be able to register multiple devices by entering Product Number and Serial Number
- [main] The user MUST be able to delete registered devices with confirmation
- [main] The system MUST display an empty state message when no devices are registered
- [main] The user MAY access a collapsible "How to find device information" guide with visual examples

### Documentation Criteria
- [doc] User documentation MUST include instructions for accessing the Settings page from the account menu
- [doc] User documentation MUST explain the difference between primary and alternate email addresses
- [doc] User documentation MUST provide clear guidance on locating device Product Numbers and Serial Numbers on ThinkPad devices
- [doc] User documentation SHOULD include screenshots of the BIOS information screen showing device details
- [doc] Terms & Conditions documentation MUST include links to full legal text for both Lenovo and Software Publisher terms

### Technical Criteria
- [tech] The solution MUST persist all settings data using browser localStorage with the following keys:
  - `primaryEmail`: String for primary email address
  - `alternateEmail`: String for alternate email address
  - `termsAcceptance`: JSON object with `lenovo` and `publisher` boolean flags
  - `devices`: JSON array of device objects containing `id`, `productNumber`, `serialNumber`, and `addedDate`
- [tech] Email validation MUST use RFC 5322 compliant regex pattern: `/^[^\s@]+@[^\s@]+\.[^\s@]+$/`
- [tech] The system MUST sanitize all user input to prevent XSS attacks using HTML escaping
- [tech] Device Product Numbers and Serial Numbers MUST be at least 5 characters in length
- [tech] The system MUST prevent duplicate device registration by comparing both product and serial numbers
- [tech] The settings page MUST be responsive and support the following breakpoints:
  - Desktop: 1440px (default)
  - Tablet: ≤900px
  - Mobile: ≤600px
- [tech] The implementation SHOULD follow Lenovo Cake Design System styling conventions
- [tech] Success messages SHOULD auto-dismiss after 3000ms (3 seconds)
- [tech] The system MAY implement fade-in animations for success and error messages using CSS keyframes

### Testing Criteria
- [test] Email validation tests MUST verify rejection of invalid formats including:
  - Missing @ symbol
  - Missing domain
  - Missing TLD
  - Whitespace in email
- [test] Duplicate device detection tests MUST verify both case-insensitive matching and exact string matching
- [test] localStorage persistence tests MUST verify data retention across browser refresh and navigation
- [test] Form validation tests MUST cover all required field combinations
- [test] Responsive design tests MUST verify layout correctness at 1440px, 900px, and 600px viewport widths
- [test] Accessibility tests SHOULD verify keyboard navigation and screen reader compatibility for all interactive elements

### User Acceptance Criteria
- [uat] A user can navigate from the homepage to Settings by clicking the avatar icon and selecting "Settings"
- [uat] A user can add an alternate email address, refresh the page, and see the email persisted
- [uat] A user can check both terms and conditions checkboxes, refresh the page, and see both remain checked
- [uat] A user can add a new device with product number "21Q7ZCM0US" and serial number "PF5AWM6A", and the device appears in the device list
- [uat] A user can delete a registered device and confirm the deletion dialog, and the device is removed from the list
- [uat] A user can expand the "How to find device information" guide and view the example image
- [uat] A user attempting to add a duplicate device receives an error message stating "This device is already registered"
- [uat] A user attempting to set the alternate email to match the primary email receives an error message

## ASSUMPTIONS
- The user is already authenticated and has a valid primary email address set during registration
- The primary email address is managed through a separate account registration flow and cannot be changed from the Settings page
- Terms and Conditions URLs point to valid Lenovo legal documentation (currently using https://www.lenovo.com/us/en/privacy/)
- Device Product Numbers and Serial Numbers follow Lenovo's standard format (alphanumeric, minimum 5 characters)
- The Settings page is a UI mockup for design purposes and does not integrate with backend services
- Browser localStorage is available and enabled (falls back to default values if not available)
- Users understand that settings are stored locally per browser and will not sync across devices
- The ThinkPad X9-15 Gen 1 device shown in the how-to guide is representative of all ThinkPad models
- Users with JavaScript disabled will not be able to use the Settings page functionality

## REFERENCES
[1] Lenovo Cake Design System: https://cake.lenovo.com/
[2] RFC 5322 Email Validation: https://tools.ietf.org/html/rfc5322
[3] Lenovo Privacy Policy: https://www.lenovo.com/us/en/privacy/
[4] WCAG 2.1 Accessibility Guidelines: https://www.w3.org/WAI/WCAG21/quickref/
[5] localStorage API Documentation: https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage

## NOTES
- Implementation uses vanilla JavaScript without frameworks to maintain consistency with the static site architecture
- The settings page header includes a "Back to Home" link with the Lenovo logo for easy navigation
- Device list displays devices in chronological order (most recently added first) using the `addedDate` timestamp
- The how-to guide includes an inline SVG placeholder image that can be replaced with an actual screenshot later
- Developer utility functions `exportSettings()` and `clearAllSettings()` are available in browser console for debugging
- Terms acceptance creates a success message with a green checkmark icon for positive user feedback
- Email form and device form use inline display with show/hide toggle to maintain compact UI
- Delete device action requires explicit user confirmation via browser `confirm()` dialog
- The implementation matches the existing homepage styling including footer with Privacy Policy, Terms of Use, and Contact Support links
- Settings data structure is designed to be easily exportable to JSON for future backend integration
- All text content uses Lato font family to match Lenovo brand guidelines
- Color palette follows Lenovo design system variables (midnight blues, carbon grays, mercury neutrals)
- Form validation provides immediate inline feedback rather than requiring form submission
- Empty state for device list includes an icon and helpful message to guide first-time users
- Related Story: S1.2 - User Profile Management (depends on primary email being editable)
- Related Story: S1.3 - Device Warranty Lookup (requires device registration data)

---------------------------------------------------------------

**TODOs in this story:** 0
All requirements are fully specified based on implemented functionality

**INVEST Checklist:**
- ✅ Independent: Can be completed without other stories (uses only localStorage, no backend dependencies)
- ✅ Negotiable: Email validation rules, device field lengths, and UI layout can be discussed
- ✅ Valuable: Clear value to users (manage contact info, accept terms, track devices)
- ✅ Estimable: Implementation complexity is apparent (3-5 days for full-stack, already completed for mockup)
- ✅ Small: Completable in one sprint (single feature area with three related sections)
- ✅ Testable: Clear verification criteria with specific user acceptance tests

**SMART Checklist:**
- ✅ Specific: Precise AC for each feature (email validation, terms checkboxes, device CRUD)
- ✅ Measurable: Quantitatively verifiable (5 character minimum, 3000ms timeout, 3 breakpoints)
- ✅ Attainable: Realistic implementation using standard web technologies and localStorage
- ✅ Relevant: All AC directly related to settings management (no unrelated requirements)
- ✅ Time-bound: Clear scope bounded to settings page functionality (excludes profile editing, authentication)
